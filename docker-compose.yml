version: '2'
services:
  cyanite:
    build: ./apps/cyanite
    ports:
      - 8080:8080
      - 2003:2003
    depends_on:
      - cassandra
      - cassandra_schema
    networks:
      - cyanite
  cassandra:
    image: cassandra:3.0
    networks:
      - cyanite
  cassandra_schema:
    image: cassandra:3.0
    networks:
      - cyanite
    command: cqlsh cassandra -f /tmp/schema.cql
    volumes:
      - ./apps/cassandra/schema.cql:/tmp/schema.cql
    depends_on:
      - cassandra
  collectd:
    build: ./apps/collectd
    depends_on:
      - cyanite
    networks:
      - cyanite
networks:
  cyanite:
    driver: bridge
